"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4096],{1513:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>c,toc:()=>h});var s=t(5893),r=t(1151),a=t(4866),i=t(5162);const l={id:"layout",title:"@podium/layout"},o=void 0,c={id:"api/layout",title:"@podium/layout",description:"In Podium a layout server is mainly responsible for fetching HTML fragments",source:"@site/docs/api/layout.md",sourceDirName:"api",slug:"/api/layout",permalink:"/docs/api/layout",draft:!1,unlisted:!1,editUrl:"https://github.com/podium-lib/podium-lib.github.io/tree/main/website/docs/docs/api/layout.md",tags:[],version:"current",frontMatter:{id:"layout",title:"@podium/layout"},sidebar:"sidebar",previous:{title:"@podium/podlet",permalink:"/docs/api/podlet"},next:{title:"@podium/browser",permalink:"/docs/api/browser"}},d={},h=[{value:"Installation",id:"installation",level:2},{value:"Getting started",id:"getting-started",level:2},{value:"Constructor",id:"constructor",level:2},{value:"options",id:"options",level:4},{value:"name",id:"name",level:5},{value:"pathname",id:"pathname",level:5},{value:"logger",id:"logger",level:5},{value:"context",id:"context",level:5},{value:"client",id:"client",level:5},{value:"proxy",id:"proxy",level:5},{value:"Layout Instance",id:"layout-instance",level:2},{value:".middleware()",id:"middleware",level:3},{value:".js(options|[options])",id:"jsoptionsoptions",level:3},{value:"options",id:"options-1",level:4},{value:"value",id:"value",level:5},{value:"prefix",id:"prefix",level:5},{value:"type",id:"type",level:5},{value:".css(options|[options])",id:"cssoptionsoptions",level:3},{value:"options",id:"options-2",level:4},{value:"value",id:"value-1",level:5},{value:"prefix",id:"prefix-1",level:5},{value:".pathname()",id:"pathname-1",level:3},{value:".view(template)",id:"viewtemplate",level:3},{value:".render(HttpIncoming, fragment, [args])",id:"renderhttpincoming-fragment-args",level:3},{value:"HttpIncoming (required)",id:"httpincoming-required",level:4},{value:"fragment",id:"fragment",level:4},{value:"[args]",id:"args",level:4},{value:".process(HttpIncoming)",id:"processhttpincoming",level:3},{value:"HttpIncoming (required)",id:"httpincoming-required-1",level:4},{value:".client",id:"client-1",level:3},{value:".client.register(options)",id:"clientregisteroptions",level:3},{value:"options (required)",id:"options-required",level:4},{value:".client.refreshManifests()",id:"clientrefreshmanifests",level:3},{value:".client.state",id:"clientstate",level:3},{value:".client Events",id:"client-events",level:3},{value:"state",id:"state",level:4},{value:".context",id:"context-1",level:3},{value:".context.register(name, parser)",id:"contextregistername-parser",level:3},{value:"name (required)",id:"name-required",level:4},{value:"parser (required)",id:"parser-required",level:4},{value:".metrics",id:"metrics",level:3},{value:"Podlet Resource",id:"podlet-resource",level:2},{value:".fetch(HttpIncoming, options)",id:"fetchhttpincoming-options",level:3},{value:"HttpIncoming (required)",id:"httpincoming-required-2",level:4},{value:"options (optional)",id:"options-optional",level:4},{value:"return value",id:"return-value",level:4},{value:".stream(HttpIncoming, options)",id:"streamhttpincoming-options",level:3},{value:"HttpIncoming (required)",id:"httpincoming-required-3",level:4},{value:"options (optional)",id:"options-optional-1",level:4},{value:"Event: beforeStream",id:"event-beforestream",level:4},{value:".refresh()",id:"refresh",level:3},{value:".name",id:"name-1",level:3},{value:".uri",id:"uri",level:3},{value:"Podlet Response",id:"podlet-response",level:2},{value:"res.podiumSend(fragment)",id:"respodiumsendfragment",level:2}];function p(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"In Podium a layout server is mainly responsible for fetching HTML fragments\n(podlets) and stitching these fragments together into an HTML page (a layout)."}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"@podium/layout"})," module is used for composing HTML pages (layouts) out of\npage fragments (podlets)."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"@podium/layout"})," module provide three core features:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A client used to fetch content from podlets"}),"\n",(0,s.jsx)(n.li,{children:"A context used to set request bound information on requests from a layout to its podlets when fetching content from them"}),"\n",(0,s.jsx)(n.li,{children:"A proxy that makes it possible to publicly expose podlet data endpoints (or any backend services) via the layout"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This module is to be used in conjunction with a Node.js HTTP server. For this,\nExpress js, Hapi and Fastify are all supported. It's also possible to write your\nserver using other HTTP frameworks or even just using the core Node.js HTTP\nlibraries."}),"\n",(0,s.jsxs)(n.p,{children:["Connect compatible middleware based frameworks (such as ",(0,s.jsx)(n.a,{href:"https://expressjs.com/",title:"Express",children:"Express"}),") are\nconsidered first class in Podium and as such the layout module provides a\n",(0,s.jsx)(n.code,{children:".middleware()"})," method for convenience."]}),"\n",(0,s.jsxs)(n.p,{children:["For writing layout servers with other HTTP frameworks, please see the\n",(0,s.jsx)(n.a,{href:"/docs/api/getting_started#http-framework-compabillity",children:"HTTP Framework Compabillity"}),"\nsection."]}),"\n",(0,s.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ npm install @podium/layout\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ npm install @podium/layout\n$ npm install @podium/hapi-layout\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ npm install @podium/layout\n$ npm install @podium/fastify-layout\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"getting-started",children:"Getting started"}),"\n",(0,s.jsx)(n.p,{children:"Building a simple layout server including two podlets:"}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const express = require('express');\nconst Layout = require('@podium/layout');\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst podletA = layout.client.register({\n    name: 'myPodletA',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\nconst podletB = layout.client.register({\n    name: 'myPodletB',\n    uri: 'http://localhost:7200/manifest.json',\n});\n\nconst app = express();\napp.use(layout.middleware());\n\napp.get(layout.pathname(), async (req, res, next) => {\n    const incoming = res.locals.podium;\n\n    const [a, b] = await Promise.all([\n        podletA.fetch(incoming),\n        podletB.fetch(incoming),\n    ]);\n\n    res.podiumSend(`\n        <section>${a.content}</section>\n        <section>${b.content}</section>\n    `);\n});\n\napp.listen(7000);\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const HapiLayout = require('@podium/hapi-layout');\nconst Layout = require('@podium/layout');\nconst Hapi = require('hapi');\n\nconst app = Hapi.Server({\n    host: 'localhost',\n    port: 7000,\n});\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst podletA = layout.client.register({\n    name: 'myPodletA',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\nconst podletB = layout.client.register({\n    name: 'myPodletB',\n    uri: 'http://localhost:7200/manifest.json',\n});\n\napp.register({\n    plugin: new HapiLayout(),\n    options: layout,\n});\n\napp.route({\n    method: 'GET',\n    path: layout.pathname(),\n    handler: (request, h) => {\n        const incoming = request.app.podium;\n\n        const [a, b] = await Promise.all([\n            podletA.fetch(incoming),\n            podletB.fetch(incoming),\n        ]);\n\n        h.podiumSend(`\n            <section>${a.content}</section>\n            <section>${b.content}</section>\n        `);\n\n    },\n});\n\napp.start();\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const fastifyLayout = require('@podium/fastify-layout');\nconst fastify = require('fastify');\nconst Layout = require('@podium/layout');\n\nconst app = fastify();\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst podletA = layout.client.register({\n    name: 'myPodletA',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\nconst podletB = layout.client.register({\n    name: 'myPodletB',\n    uri: 'http://localhost:7200/manifest.json',\n});\n\napp.register(fastifyLayout, layout);\n\napp.get(layout.pathname(), async (request, reply) => {\n    const incoming = reply.app.podium;\n\n    const [a, b] = await Promise.all([\n        podletA.fetch(incoming),\n        podletB.fetch(incoming),\n    ]);\n\n    reply.podiumSend(`\n        <section>${a.content}</section>\n        <section>${b.content}</section>\n    `);\n});\n\nconst start = async () => {\n    try {\n        await app.listen(7000);\n        app.log.info(`server listening on ${app.server.address().port}`);\n    } catch (err) {\n        app.log.error(err);\n        process.exit(1);\n    }\n}\nstart();\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const { HttpIncoming } = require('@podium/utils');\nconst Layout = require('@podium/layout');\nconst http = require('http');\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst podletA = layout.client.register({\n    name: 'myPodletA',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\nconst podletB = layout.client.register({\n    name: 'myPodletB',\n    uri: 'http://localhost:7200/manifest.json',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    if (incoming.url.pathname === layout.pathname()) {\n\n        const [a, b] = await Promise.all([\n            podletA.fetch(incoming),\n            podletB.fetch(incoming),\n        ]);\n\n        res.statusCode = 200;\n        res.setHeader('Content-Type', 'text/html');\n\n        res.end(layout.render(incoming, `\n            <section>${a.content}</section>\n            <section>${b.content}</section>\n        `));\n        return;\n    }\n\n    res.statusCode = 404;\n    res.setHeader('Content-Type', 'text/plain');\n    res.end('Not found');\n});\n\nserver.listen(7000);\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"constructor",children:"Constructor"}),"\n",(0,s.jsx)(n.p,{children:"Create a new layout instance."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout(options);\n"})}),"\n",(0,s.jsx)(n.h4,{id:"options",children:"options"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"option"}),(0,s.jsx)(n.th,{children:"type"}),(0,s.jsx)(n.th,{children:"default"}),(0,s.jsx)(n.th,{children:"required"}),(0,s.jsx)(n.th,{children:"details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"name"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{children:"\u2713"}),(0,s.jsx)(n.td,{children:"Name that the layout identifies itself by"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"pathname"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{children:"\u2713"}),(0,s.jsx)(n.td,{children:"Pathname of where a layout is mounted in an HTTP server"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"logger"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"A logger which conforms to the log4j interface"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"context"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Options to be passed on to the internal @podium/context constructor"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"client"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Options to be passed on to the internal @podium/client constructor"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"proxy"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Options to be passed on to the internal @podium/proxy constructor"})]})]})]}),"\n",(0,s.jsx)(n.h5,{id:"name",children:"name"}),"\n",(0,s.jsx)(n.p,{children:"The name that the layout identifies itself by. This value must be in camelCase."}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayoutName',\n    pathname: '/foo',\n});\n"})}),"\n",(0,s.jsx)(n.h5,{id:"pathname",children:"pathname"}),"\n",(0,s.jsx)(n.p,{children:"The Pathname to where the layout is mounted in an HTTP server. It is important\nthat this value matches the entry point of the route where content is served in\nthe HTTP server since this value is used to mount the proxy and inform podlets\n(through the Podium context) where they are mounted and where the proxy is\nmounted."}),"\n",(0,s.jsxs)(n.p,{children:['If the layout is mounted at the server "root", set the ',(0,s.jsx)(n.code,{children:"pathname"})," to ",(0,s.jsx)(n.code,{children:"/"}),":"]}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = express();\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.use(layout.middleware());\n\napp.get('/', (req, res, next) => {\n    [ ... ]\n});\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = Hapi.Server({\n    host: 'localhost',\n    port: 7000,\n});\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.register({\n    plugin: new HapiLayout(),\n    options: layout,\n});\n\napp.route({\n    method: 'GET',\n    path: '/',\n    handler: (request, h) => {\n        [ ... ]\n    },\n});\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = fastify();\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.register(fastifyLayout, layout);\n\napp.get('/', async (request, reply) => {\n    [ ... ]\n});\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    if (incoming.url.pathname === '/') {\n        [ ... ]\n    }\n});\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["If the layout is mounted at ",(0,s.jsx)(n.code,{children:"/foo"}),", set the ",(0,s.jsx)(n.code,{children:"pathname"})," to ",(0,s.jsx)(n.code,{children:"/foo"}),":"]}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = express();\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n});\n\napp.use('/foo', layout.middleware());\n\napp.get('/foo', (req, res, next) => {\n    [ ... ]\n});\n\napp.get('/foo/:id', (req, res, next) => {\n    [ ... ]\n});\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = Hapi.Server({\n    host: 'localhost',\n    port: 7000,\n});\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n});\n\napp.register({\n    plugin: new HapiLayout(),\n    options: layout,\n});\n\napp.route({\n    method: 'GET',\n    path: '/foo',\n    handler: (request, h) => {\n        [ ... ]\n    },\n});\n\napp.route({\n    method: 'GET',\n    path: '/foo/{id}',\n    handler: (request, h) => {\n        [ ... ]\n    },\n});\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = fastify();\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n});\n\napp.register(fastifyLayout, layout);\n\napp.get('/foo', async (request, reply) => {\n    [ ... ]\n});\n\napp.get('/foo/:id', async (request, reply) => {\n    [ ... ]\n});\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    if (incoming.url.pathname === '/foo') {\n        [ ... ]\n    }\n\n    if (incoming.url.pathname.startsWith('/foo/')) {\n        [ ... ]\n    }\n});\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["There is also a helper method for retrieving the set ",(0,s.jsx)(n.code,{children:"pathname"})," which can be\nused to get the pathname from the layout object when defining routes.\nSee ",(0,s.jsx)(n.a,{href:"#pathname-1",children:(0,s.jsx)(n.code,{children:".pathname()"})})," for further details."]}),"\n",(0,s.jsx)(n.h5,{id:"logger",children:"logger"}),"\n",(0,s.jsx)(n.p,{children:"Any log4j compatible logger can be passed in and will be used for logging.\nConsole is also supported for easy test / development."}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n    logger: console,\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Under the hood ",(0,s.jsx)(n.a,{href:"https://github.com/trygve-lie/abslog",title:"abslog",children:"abslog"})," is used to abstract out logging. Please see ",(0,s.jsx)(n.a,{href:"https://github.com/trygve-lie/abslog",title:"abslog",children:"abslog"})," for\nfurther details."]}),"\n",(0,s.jsx)(n.h5,{id:"context",children:"context"}),"\n",(0,s.jsx)(n.p,{children:"Options to be passed on to the context parsers."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"option"}),(0,s.jsx)(n.th,{children:"type"}),(0,s.jsx)(n.th,{children:"default"}),(0,s.jsx)(n.th,{children:"required"}),(0,s.jsx)(n.th,{children:"details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"debug"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Config object passed on to the debug parser"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"locale"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Config object passed on to the locale parser"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"deviceType"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Config object passed on to the device type parser"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"mountOrigin"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Config object passed on to the mount origin parser"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"mountPathname"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Config object passed on to the mount pathname parser"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"publicPathname"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Config object passed on to the public pathname parser"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["Example of setting the ",(0,s.jsx)(n.code,{children:"debug"})," context to default ",(0,s.jsx)(n.code,{children:"true"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n    context: {\n        debug: {\n            enabled: true,\n        },\n    },\n});\n"})}),"\n",(0,s.jsx)(n.h5,{id:"client",children:"client"}),"\n",(0,s.jsx)(n.p,{children:"Options to be passed on to the client."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"option"}),(0,s.jsx)(n.th,{children:"type"}),(0,s.jsx)(n.th,{children:"default"}),(0,s.jsx)(n.th,{children:"required"}),(0,s.jsx)(n.th,{children:"details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"retries"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"4"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Number of times the client should retry settling a version number conflict before terminating"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"timeout"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"1000"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Default value, in milliseconds, for how long a request should wait before the connection is terminated"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"maxAge"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Infinity"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Default value, in milliseconds, for how long manifests should be cached"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["Example of setting ",(0,s.jsx)(n.code,{children:"retries"})," on the client to ",(0,s.jsx)(n.code,{children:"6"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n    client: {\n        retries: 6,\n    },\n});\n"})}),"\n",(0,s.jsx)(n.h5,{id:"proxy",children:"proxy"}),"\n",(0,s.jsx)(n.p,{children:"Options to be passed on to the proxy."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"option"}),(0,s.jsx)(n.th,{children:"type"}),(0,s.jsx)(n.th,{children:"default"}),(0,s.jsx)(n.th,{children:"required"}),(0,s.jsx)(n.th,{children:"details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"prefix"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"podium-resource"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Prefix used to namespace the proxy so that it's isolated from other routes in the HTTP server"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"timeout"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"6000"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Default value, in milliseconds, for how long a request should wait before the connection is terminated"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["Example of setting the ",(0,s.jsx)(n.code,{children:"timeout"})," on the proxy to 30 seconds:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n    proxy: {\n        timeout: 30000,\n    },\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"layout-instance",children:"Layout Instance"}),"\n",(0,s.jsx)(n.p,{children:"The layout instance has the following API:"}),"\n",(0,s.jsx)(n.h3,{id:"middleware",children:".middleware()"}),"\n",(0,s.jsxs)(n.p,{children:["A Connect/Express compatible middleware function which takes care of the\nvarious operations needed for a layout to operate correctly. This function is\nmore or less just a wrapper for the ",(0,s.jsx)(n.code,{children:".process()"})," method."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Important:"})," This middleware must be mounted before defining any routes."]}),"\n",(0,s.jsx)(n.p,{children:"Example"}),"\n",(0,s.jsx)(a.Z,{groupId:"server-frameworks",children:(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = express();\napp.use(layout.middleware());\n"})})})}),"\n",(0,s.jsxs)(n.p,{children:["The middleware will create an ",(0,s.jsx)(n.a,{href:"/docs/api/incoming",children:(0,s.jsx)(n.code,{children:"HttpIncoming"})})," object for each\nrequest and place it on the response at ",(0,s.jsx)(n.code,{children:"res.locals.podium"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Returns an Array of middleware functions which perform the tasks described\nabove."}),"\n",(0,s.jsx)(n.h3,{id:"jsoptionsoptions",children:".js(options|[options])"}),"\n",(0,s.jsx)(n.p,{children:"Set relative or absolute URLs to JavaScript assets for the layout."}),"\n",(0,s.jsx)(n.p,{children:"When set, the values will be internally kept and made available for the document\ntemplate to include."}),"\n",(0,s.jsx)(n.p,{children:"This method can be called multiple times with a single options object to set\nmultiple assets or one can provide an array of options objects to set multiple\nassets."}),"\n",(0,s.jsx)(n.h4,{id:"options-1",children:"options"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"option"}),(0,s.jsx)(n.th,{children:"type"}),(0,s.jsx)(n.th,{children:"default"}),(0,s.jsx)(n.th,{children:"required"}),(0,s.jsx)(n.th,{children:"details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"value"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"\u2713"}),(0,s.jsx)(n.td,{children:"Relative or absolute URL to the JavaScript asset"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"prefix"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Whether the pathname defined on the constructor should be prepend, if relative, to the value"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"type"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"default"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"What type of JavaScript (eg. esm, default, cjs)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"referrerpolicy"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<script>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"crossorigin"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<script>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"integrity"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<script>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"nomodule"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<script>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"async"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<script>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"defer"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<script>"})," element"]})]})]})]}),"\n",(0,s.jsx)(n.h5,{id:"value",children:"value"}),"\n",(0,s.jsxs)(n.p,{children:["Sets the ",(0,s.jsx)(n.code,{children:"pathname"})," for the layout's JavaScript assets. This value is usually\nthe [URL] at which the layouts's user facing JavaScript is served and can be\neither a URL [pathname] or an absolute URL."]}),"\n",(0,s.jsxs)(n.p,{children:["Serve a javascript file at ",(0,s.jsx)(n.code,{children:"/assets/main.js"}),":"]}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = express();\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.get('/assets.js', (req, res) => {\n    res.status(200).sendFile('./src/js/main.js', err => {});\n});\n\nlayout.js({ value: '/assets.js' });\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = Hapi.Server([ ... ]);\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.register({\n    plugin: new HapiLayout(),\n    options: layout,\n});\n\napp.register(require('@hapi/inert'));\n\napp.route({\n    method: 'GET',\n    path: '/assets.js',\n    handler: (request, h) => {\n        return h.file('./src/js/main.js');\n    },\n});\n\nlayout.js({ value: '/assets.js' });\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = fastify();\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.register(fastifyLayout, layout);\n\napp.register(require('fastify-static'), {\n    root: './src/js/',\n});\n\napp.get('/assets.js', (request, reply) => {\n    reply.sendFile('main.js');\n});\n\nlayout.js({ value: '/assets.js' });\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    if (incoming.url.pathname === '/assets.js') {\n        fs.readFile('./src/js/main.js', (error, data) => {\n            res.statusCode = 200;\n            res.setHeader('Content-type', 'text/javascript' );\n            res.end(data);\n        });\n        return;\n    }\n\n    [ ... ]\n});\n\nlayout.js({ value: '/assets.js' });\n"})})})]}),"\n",(0,s.jsx)(n.p,{children:"Serve assets from a static file server and set a relative URI to the JS files:"}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = express();\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.use('/assets', express.static('./src/js'));\n\nlayout.js([\n    { value: '/assets/main.js' },\n    { value: '/assets/extra.js' },\n]);\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = Hapi.Server({\n    port: 7000,\n    routes: {\n        files: {\n            relativeTo: './src/js/',\n        },\n    },\n});\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.register({\n    plugin: new HapiLayout(),\n    options: layout,\n});\n\napp.register(require('@hapi/inert'));\n\napp.route({\n    method: 'GET',\n    path: '/assets/{param*}',\n    handler: {\n        directory: {\n            path: '.',\n            redirectToSlash: true,\n        },\n    },\n});\n\nlayout.js([\n    { value: '/assets/main.js' },\n    { value: '/assets/extra.js' },\n]);\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = fastify();\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.register(fastifyLayout, layout);\n\napp.register(require('fastify-static'), {\n    root: './src/js/',\n});\n\napp.get('/assets/:file', (request, reply) => {\n    reply.sendFile(request.params.file);\n});\n\nlayout.js([\n    { value: '/assets/main.js' },\n    { value: '/assets/extra.js' },\n]);\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    const { pathname } = incoming.url;\n\n    if (pathname.startsWith('/assets/')) {\n        const file = pathname.substring(pathname.lastIndexOf('/'));\n        const sanitizedFile = path.normalize(file).replace(/^(\\.\\.[\\/\\\\])+/, '');\n\n        fs.readFile(`./src/js/${sanitizedFile}`, (error, data) => {\n            res.statusCode = 200;\n            res.setHeader('Content-type', 'text/javascript' );\n            res.end(data);\n        });\n        return;\n    }\n\n    [ ... ]\n});\n\nlayout.js([\n    { value: '/assets/main.js' },\n    { value: '/assets/extra.js' },\n]);\n"})})})]}),"\n",(0,s.jsx)(n.p,{children:"Set an absolute URL to where the JavaScript file is located:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nlayout.js({ value: 'http://cdn.mysite.com/assets/js/e7rfg76.js' });\n"})}),"\n",(0,s.jsx)(n.h5,{id:"prefix",children:"prefix"}),"\n",(0,s.jsx)(n.p,{children:"Sets whether the method should prepend the value with the pathname value that\nwas set in the constructor."}),"\n",(0,s.jsx)(n.p,{children:"The prefix will be ignored if value is an absolute URL."}),"\n",(0,s.jsx)(n.h5,{id:"type",children:"type"}),"\n",(0,s.jsxs)(n.p,{children:["Sets the type for the script which is set. If not set, ",(0,s.jsx)(n.code,{children:"default"})," will be used."]}),"\n",(0,s.jsx)(n.p,{children:"The following are valid values:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"esm"})," or ",(0,s.jsx)(n.code,{children:"module"})," for ECMAScript modules"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"cjs"})," for CommonJS modules"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"amd"})," for AMD modules"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"umd"})," for Universal Module Definition"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"default"})," if the type is unknown."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The type field provides a hint for further use of the script in the layout.\nTypically this is used in the ",(0,s.jsx)(n.a,{href:"/docs/api/document",children:"document template"})," when including\nthe ",(0,s.jsx)(n.code,{children:"<script>"})," tags or when optimizing JavaScript assets with a bundler."]}),"\n",(0,s.jsx)(n.h3,{id:"cssoptionsoptions",children:".css(options|[options])"}),"\n",(0,s.jsx)(n.p,{children:"Set relative or absolute URLs to Cascading Style Sheets (CSS) assets for the\nlayout."}),"\n",(0,s.jsx)(n.p,{children:"When set the values will be internally kept and made available for the document\ntemplate to include."}),"\n",(0,s.jsx)(n.p,{children:"This method can be called multiple times with a single options object to set\nmultiple assets or one can provide an array of options objects to set multiple\nassets."}),"\n",(0,s.jsx)(n.h4,{id:"options-2",children:"options"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"option"}),(0,s.jsx)(n.th,{children:"type"}),(0,s.jsx)(n.th,{children:"default"}),(0,s.jsx)(n.th,{children:"required"}),(0,s.jsx)(n.th,{children:"details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"value"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"\u2713"}),(0,s.jsx)(n.td,{children:"Relative or absolute URL to the CSS asset"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"prefix"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Whether the pathname defined on the constructor should be prepend, if relative, to the value"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"crossorigin"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<link>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"disabled"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<link>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"hreflang"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<link>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"title"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<link>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"media"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<link>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"type"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"text/css"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<link>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"rel"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"stylesheet"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<link>"})," element"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"as"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Correlates to the same attribute on a HTML ",(0,s.jsx)(n.code,{children:"<link>"})," element"]})]})]})]}),"\n",(0,s.jsx)(n.h5,{id:"value-1",children:"value"}),"\n",(0,s.jsxs)(n.p,{children:["Sets the ",(0,s.jsx)(n.code,{children:"pathname"})," to the layout's CSS assets. This value can be an relative or\nabsolute URL at which the podlet's user facing CSS is served.\n.\nServe a CSS file at ",(0,s.jsx)(n.code,{children:"/assets/main.css"}),":"]}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = express();\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.get('/assets.css', (req, res) => {\n    res.status(200).sendFile('./src/js/main.css', err => {});\n});\n\nlayout.css({ value: '/assets.css' });\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = Hapi.Server([ ... ]);\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.register({\n    plugin: new HapiLayout(),\n    options: layout,\n});\n\napp.register(require('@hapi/inert'));\n\napp.route({\n    method: 'GET',\n    path: '/assets.css',\n    handler: (request, h) => {\n        return h.file('./src/js/main.css');\n    },\n});\n\nlayout.css({ value: '/assets.css' });\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = fastify();\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.register(fastifyLayout, layout);\n\napp.register(require('fastify-static'), {\n    root: './src/css/',\n});\n\napp.get('/assets.css', (request, reply) => {\n    reply.sendFile('main.css');\n});\n\nlayout.css({ value: '/assets.css' });\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    if (incoming.url.pathname === '/assets.css') {\n        fs.readFile('./src/js/main.css', (error, data) => {\n            res.statusCode = 200;\n            res.setHeader('Content-type', 'text/javascript' );\n            res.end(data);\n        });\n        return;\n    }\n\n    [ ... ]\n});\n\nlayout.css({ value: '/assets.css' });\n"})})})]}),"\n",(0,s.jsx)(n.p,{children:"Serve assets from a static file server and set a relative URI to the CSS files:"}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = express();\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.use('/assets', express.static('./src/css'));\n\nlayout.css([\n    { value: '/assets/main.css' },\n    { value: '/assets/extra.css' },\n]);\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = Hapi.Server({\n    port: 7000,\n    routes: {\n        files: {\n            relativeTo: './src/css/',\n        },\n    },\n});\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.register({\n    plugin: new HapiLayout(),\n    options: layout,\n});\n\napp.register(require('@hapi/inert'));\n\napp.route({\n    method: 'GET',\n    path: '/assets/{param*}',\n    handler: {\n        directory: {\n            path: '.',\n            redirectToSlash: true,\n        },\n    },\n});\n\nlayout.css([\n    { value: '/assets/main.css' },\n    { value: '/assets/extra.css' },\n]);\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const app = fastify();\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\napp.register(fastifyLayout, layout);\n\napp.register(require('fastify-static'), {\n    root: './src/css/',\n});\n\napp.get('/assets/:file', (request, reply) => {\n    reply.sendFile(request.params.file);\n});\n\nlayout.css([\n    { value: '/assets/main.css' },\n    { value: '/assets/extra.css' },\n]);\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    const { pathname } = incoming.url;\n\n    if (pathname.startsWith('/assets/')) {\n        const file = pathname.substring(pathname.lastIndexOf('/'));\n        const sanitizedFile = path.normalize(file).replace(/^(\\.\\.[\\/\\\\])+/, '');\n\n        fs.readFile(`./src/css/${sanitizedFile}`, (error, data) => {\n            res.statusCode = 200;\n            res.setHeader('Content-type', 'text/javascript' );\n            res.end(data);\n        });\n        return;\n    }\n\n    [ ... ]\n});\n\nlayout.css([\n    { value: '/assets/main.css' },\n    { value: '/assets/extra.css' },\n]);\n"})})})]}),"\n",(0,s.jsx)(n.p,{children:"Set an absolute URL to where the CSS file is located:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nlayout.css({ value: 'http://cdn.mysite.com/assets/css/3ru39ur.css' });\n"})}),"\n",(0,s.jsx)(n.h5,{id:"prefix-1",children:"prefix"}),"\n",(0,s.jsx)(n.p,{children:"Sets whether the method should prepend the value with the pathname value that\nwas set in the constructor."}),"\n",(0,s.jsx)(n.p,{children:"The prefix will be ignored if value is an absolute URL."}),"\n",(0,s.jsx)(n.h3,{id:"pathname-1",children:".pathname()"}),"\n",(0,s.jsxs)(n.p,{children:["A helper method used to retrieve the ",(0,s.jsx)(n.code,{children:"pathname"})," value that was set in the\nconstructor. This can be handy when defining routes since the ",(0,s.jsx)(n.code,{children:"pathname"}),"\nset in the constructor must also be the base path for the layout's main content\nroute"]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n});\n\napp.get(layout.pathname(), (req, res, next) => {\n    [ ... ]\n});\n\napp.get(`${layout.pathname()}/bar`, (req, res, next) => {\n    [ ... ]\n});\n\napp.get(`${layout.pathname()}/bar/:id`, (req, res, next) => {\n    [ ... ]\n});\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n});\n\napp.route({\n    method: 'GET',\n    path: layout.pathname(),\n    handler: (request, h) => {\n        [ ... ]\n    },\n});\n\napp.route({\n    method: 'GET',\n    path: `${layout.pathname()}/bar`,\n    handler: (request, h) => {\n        [ ... ]\n    },\n});\n\napp.route({\n    method: 'GET',\n    path: `${layout.pathname()}/bar/{id}`,\n    handler: (request, h) => {\n        [ ... ]\n    },\n});\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n});\n\napp.get(layout.pathname(), async (request, reply) => {\n    [ ... ]\n});\n\napp.get(`${layout.pathname()}/bar`, async (request, reply) => {\n    [ ... ]\n});\n\napp.get(`${layout.pathname()}/bar/:id`, async (request, reply) => {\n    [ ... ]\n});\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/foo',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    const { pathname } = incoming.url;\n\n    if (pathname === layout.pathname()) {\n        [ ... ]\n    }\n\n    if (pathname === `${layout.pathname()}/bar`) {\n        [ ... ]\n    }\n\n    if (pathname.startsWith(`${layout.pathname()}/bar/`)) {\n        [ ... ]\n    }\n});\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"viewtemplate",children:".view(template)"}),"\n",(0,s.jsxs)(n.p,{children:["Sets the default ",(0,s.jsx)(n.a,{href:"/docs/api/document",children:"document template"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Takes a template function that accepts an instance of ",(0,s.jsx)(n.a,{href:"/docs/api/incoming",children:(0,s.jsx)(n.code,{children:"HttpIncoming"})}),",\na content string as well as any additional markup for the document's head\nsection:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"(incoming, body, head) => `Return an HTML string here`;\n"})}),"\n",(0,s.jsx)(n.p,{children:"In practice this might look something like:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'layout.view((incoming, body, head) => `<!doctype html>\n<html lang="${incoming.context.locale}">\n    <head>\n        <meta charset="${incoming.view.encoding}">\n        <title>${incoming.view.title}</title>\n        ${head}\n    </head>\n    <body>\n        ${body}\n    </body>\n</html>`;\n);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"renderhttpincoming-fragment-args",children:".render(HttpIncoming, fragment, [args])"}),"\n",(0,s.jsxs)(n.p,{children:["Method to render the ",(0,s.jsx)(n.a,{href:"/docs/api/document",children:"document template"}),". By default this will\nrender a default ",(0,s.jsx)(n.a,{href:"/docs/api/document",children:"document template"})," provided by Podium unless\na custom one is set by using the ",(0,s.jsx)(n.code,{children:".view"})," method."]}),"\n",(0,s.jsxs)(n.p,{children:["In most HTTP frameworks this method can be ignored in favour of\n",(0,s.jsx)(n.code,{children:"res.podiumSend()"}),". If present, ",(0,s.jsx)(n.code,{children:"res.podiumSend()"})," has the advantage that it's\nnot necessary to pass in ",(0,s.jsx)(n.a,{href:"/docs/api/incoming",children:(0,s.jsx)(n.code,{children:"HttpIncoming"})})," as the first argument."]}),"\n",(0,s.jsxs)(n.p,{children:["Returns a ",(0,s.jsx)(n.code,{children:"String"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"This method takes the following arguments:"}),"\n",(0,s.jsx)(n.h4,{id:"httpincoming-required",children:"HttpIncoming (required)"}),"\n",(0,s.jsxs)(n.p,{children:["An instance of the ",(0,s.jsx)(n.a,{href:"/docs/api/incoming",children:(0,s.jsx)(n.code,{children:"HttpIncoming"})})," class."]}),"\n",(0,s.jsx)(n.h4,{id:"fragment",children:"fragment"}),"\n",(0,s.jsxs)(n.p,{children:["A ",(0,s.jsx)(n.code,{children:"String"})," that is intended to be a fragment of the final HTML document\n(Everything to be displayed in the HTML body)."]}),"\n",(0,s.jsx)(n.h4,{id:"args",children:"[args]"}),"\n",(0,s.jsxs)(n.p,{children:["All following arguments given to the method will be passed on to the\n",(0,s.jsx)(n.a,{href:"/docs/api/document",children:"document template"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Additional arguments could be used to pass on parts of a page to the\n",(0,s.jsx)(n.a,{href:"/docs/api/document",children:"document template"})," as shown:"]}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"layout.view = (incoming, body, head) => {\n    return `\n        <html>\n            <head>${head}</head>\n            <body>${body}</body>\n        </html>\n    `;\n};\n\napp.get(layout.pathname(), (req, res) => {\n    const incoming = res.locals.podium;\n\n    const head = `<meta ..... />`;\n    const body = `<section>my content</section>`;\n\n    const document = layout.render(incoming, body, head);\n\n    res.send(document);\n});\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"layout.view = (incoming, body, head) => {\n    return `\n        <html>\n            <head>${head}</head>\n            <body>${body}</body>\n        </html>\n    `;\n};\n\napp.route({\n    method: 'GET',\n    path: layout.pathname(),\n    handler: (request, h) => {\n        const incoming = request.app.podium;\n\n        const head = `<meta ..... />`;\n        const body = `<section>my content</section>`;\n\n        return layout.render(incoming, body, head);\n    },\n});\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"layout.view = (incoming, body, head) => {\n    return `\n        <html>\n            <head>${head}</head>\n            <body>${body}</body>\n        </html>\n    `;\n};\n\napp.get(layout.pathname(), async (request, reply) => {\n    const incoming = reply.app.podium;\n\n    const head = `<meta ..... />`;\n    const body = `<section>my content</section>`;\n\n    const document = layout.render(incoming, body, head);\n\n    reply.send(document);\n});\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"layout.view = (incoming, body, head) => {\n    return `\n        <html>\n            <head>${head}</head>\n            <body>${body}</body>\n        </html>\n    `;\n};\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    const head = `<meta ..... />`;\n    const body = `<section>my content</section>`;\n\n    const document = layout.render(incoming, body, head);\n\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/html');\n    res.end(layout.render(incoming, body, head));\n});\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"processhttpincoming",children:".process(HttpIncoming)"}),"\n",(0,s.jsx)(n.p,{children:"Method for processing an incoming HTTP request. This method is intended to be\nused to implement support for multiple HTTP frameworks and in most cases it\nwon't be necessary for layout developers to use this method directly when\ncreating a layout server."}),"\n",(0,s.jsx)(n.p,{children:"What it does:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Runs context parsers on the incoming request and sets an object with the context at ",(0,s.jsx)(n.code,{children:"HttpIncoming.context"})," which can be passed on to the client when requesting content from podlets."]}),"\n",(0,s.jsx)(n.li,{children:"Mounts a proxy so that each podlet can do transparent proxy requests as needed."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Returns a Promise which will resolve with the ",(0,s.jsx)(n.a,{href:"/docs/api/incoming",children:(0,s.jsx)(n.code,{children:"HttpIncoming"})}),"\nobject that was passed in."]}),"\n",(0,s.jsxs)(n.p,{children:["If the inbound request matches a proxy endpoint the returned Promise will\nresolve with a ",(0,s.jsx)(n.a,{href:"/docs/api/incoming",children:(0,s.jsx)(n.code,{children:"HttpIncoming"})})," object where the ",(0,s.jsx)(n.code,{children:".proxy"})," property\nis set to ",(0,s.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"This method takes the following arguments:"}),"\n",(0,s.jsx)(n.h4,{id:"httpincoming-required-1",children:"HttpIncoming (required)"}),"\n",(0,s.jsxs)(n.p,{children:["An instance of the ",(0,s.jsx)(n.a,{href:"/docs/api/incoming",children:(0,s.jsx)(n.code,{children:"HttpIncoming"})})," class."]}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express"}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const { HttpIncoming } = require('@podium/utils');\nconst Layout = require('@podium/layout');\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst server = http.createServer(async (req, res) => {\n    const incoming = new HttpIncoming(req, res);\n\n    try {\n        const result = await layout.process(incoming);\n        if (result.proxy) return;\n\n        res.statusCode = 200;\n        res.setHeader('Content-Type', 'application/json');\n        res.end(JSON.stringify(result));\n    } catch (error) {\n        res.statusCode = 500;\n        res.setHeader('Content-Type', 'text/plain');\n        res.end('Internal server error');\n    }\n});\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"client-1",children:".client"}),"\n",(0,s.jsx)(n.p,{children:"A property that exposes an instance of the client for retrieving content from\npodlets."}),"\n",(0,s.jsx)(n.p,{children:"Example of registering two podlets and retrieving their content:"}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst podletA = layout.client.register({\n    name: 'myPodletA',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\nconst podletB = layout.client.register({\n    name: 'myPodletB',\n    uri: 'http://localhost:7200/manifest.json',\n});\n\n[ ... ]\n\napp.get(layout.pathname(), async (req, res, next) => {\n    const incoming = res.locals.podium;\n\n    const [a, b] = await Promise.all([\n        podletA.fetch(incoming),\n        podletB.fetch(incoming),\n    ]);\n\n    [ ... ]\n});\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst podletA = layout.client.register({\n    name: 'myPodletA',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\nconst podletB = layout.client.register({\n    name: 'myPodletB',\n    uri: 'http://localhost:7200/manifest.json',\n});\n\n[ ... ]\n\napp.route({\n    method: 'GET',\n    path: layout.pathname(),\n    handler: (request, h) => {\n        const incoming = request.app.podium;\n\n        const [a, b] = await Promise.all([\n            podletA.fetch(incoming),\n            podletB.fetch(incoming),\n        ]);\n\n        [ ... ]\n    },\n});\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst podletA = layout.client.register({\n    name: 'myPodletA',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\nconst podletB = layout.client.register({\n    name: 'myPodletB',\n    uri: 'http://localhost:7200/manifest.json',\n});\n\n[ ... ]\n\napp.get(layout.pathname(), async (request, reply) => {\n    const incoming = reply.app.podium;\n\n    const [a, b] = await Promise.all([\n        podletA.fetch(incoming),\n        podletB.fetch(incoming),\n    ]);\n\n    [ ... ]\n});\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nconst podletA = layout.client.register({\n    name: 'myPodletA',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\nconst podletB = layout.client.register({\n    name: 'myPodletB',\n    uri: 'http://localhost:7200/manifest.json',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    const [a, b] = await Promise.all([\n        podletA.fetch(incoming),\n        podletB.fetch(incoming),\n    ]);\n\n    [ ... ]\n});\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"clientregisteroptions",children:".client.register(options)"}),"\n",(0,s.jsx)(n.p,{children:"Registers a podlet such that the podlet's content can later be fetched."}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns a ",(0,s.jsx)(n.a,{href:"#podlet-resource",children:"Podlet Resource"})," which is also stored on the\nlayout client instance using the registered ",(0,s.jsx)(n.code,{children:"name"})," value as its property name."]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nlayout.client.register({\n    uri: 'http://foo.site.com/manifest.json',\n    name: 'fooBar',\n});\nlayout.client.fooBar.fetch();\n"})}),"\n",(0,s.jsx)(n.h4,{id:"options-required",children:"options (required)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"option"}),(0,s.jsx)(n.th,{children:"type"}),(0,s.jsx)(n.th,{children:"default"}),(0,s.jsx)(n.th,{children:"required"}),(0,s.jsx)(n.th,{children:"details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"uri"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"\u2713"}),(0,s.jsx)(n.td,{children:"Uri to the manifest of a podlet"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"name"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"\u2713"}),(0,s.jsx)(n.td,{children:"Name of the component. This is used to reference the component in your application, and does not have to match the name of the component itself"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"retries"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"4"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["The number of times the client should retry to settle a version number conflict before terminating. Overrides the ",(0,s.jsx)(n.code,{children:"retries"})," option in the layout constructor"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"timeout"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"number"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"1000"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Defines how long, in milliseconds, a request should wait before the connection is terminated. Overrides the ",(0,s.jsx)(n.code,{children:"timeout"})," option in the layout constructor"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"throwable"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["Defines whether an error should be thrown if a failure occurs during the process of fetching a podlet. ",(0,s.jsx)(n.a,{href:"/docs/layout/unavailable_podlets",children:"See handling podlet unavailability"}),"."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"resolveJs"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Defines whether to resolve relative URIs to absolute URIs for JavaScript assets"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"resolveCss"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"boolean"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"Defines whether to resolve relative URIs to absolute URIs for CSS assets"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"clientrefreshmanifests",children:".client.refreshManifests()"}),"\n",(0,s.jsxs)(n.p,{children:["Refreshes the manifests of all registered resources. Does so by calling the\n",(0,s.jsx)(n.code,{children:".refresh()"})," method on all resources under the hood."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"layout.client.register({\n    uri: 'http://foo.site.com/manifest.json',\n    name: 'foo',\n});\n\nlayout.client.register({\n    uri: 'http://bar.site.com/manifest.json',\n    name: 'bar',\n});\n\nawait layout.client.refreshManifests();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"clientstate",children:".client.state"}),"\n",(0,s.jsxs)(n.p,{children:['What state the client is in. See the section\n"',(0,s.jsx)(n.a,{href:"#podlet-update-life-cycle",children:"Podlet update life cycle"}),'" for more information.']}),"\n",(0,s.jsx)(n.p,{children:"The value will be one of the following values:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"instantiated"})," - When a ",(0,s.jsx)(n.code,{children:"Client"})," has been instantiated but no requests to any podlets have been made."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"initializing"})," - When one or more podlets are requested for the first time."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"unstable"})," - When an update of a podlet is detected and the layout is in the process of re-fetching the manifest."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"stable"})," - When all registered podlets are using cached manifests and only fetching content."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"unhealthy"})," - When an podlet update never settled."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"client-events",children:".client Events"}),"\n",(0,s.jsx)(n.p,{children:"The Client instance emits the following events:"}),"\n",(0,s.jsx)(n.h4,{id:"state",children:"state"}),"\n",(0,s.jsxs)(n.p,{children:['When there is a change in state. See the section\n"',(0,s.jsx)(n.a,{href:"#podlet-update-life-cycle",children:"Podlet update life cycle"}),'" for more information.']}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"layout.client.on('state', state => {\n    console.log(state);\n});\n\nconst podlet = layout.client.register({\n    uri: 'http://foo.site.com/manifest.json',\n    name: 'foo',\n});\n\npodlet.fetch();\n"})}),"\n",(0,s.jsx)(n.p,{children:"The event will fire with one the following values:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"instantiated"})," - When a ",(0,s.jsx)(n.code,{children:"Client"})," has been instantiated but no requests to any podlets have been made."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"initializing"})," - When one or multiple podlets are requested for the very first time."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"unstable"})," - When an update of a podlet is detected and is in the process of refetching the manifest."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"stable"})," - When all registered podlets are using cached manifests and only fetching content."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"unhealthy"})," - When an update of a podlet never settled."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"context-1",children:".context"}),"\n",(0,s.jsx)(n.p,{children:"A property that exposes the instance of the @podium/context used to create the\ncontext which is appended to the requests to each podlet."}),"\n",(0,s.jsx)(n.h3,{id:"contextregistername-parser",children:".context.register(name, parser)"}),"\n",(0,s.jsx)(n.p,{children:"The context is extensible so it is possible to register third party context\nparsers to it."}),"\n",(0,s.jsx)(n.p,{children:"Example of registering a custom third party context parser to the context:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const Parser = require('my-custom-parser');\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/',\n});\n\nlayout.context.register('customParser', new Parser('someConfig'));\n"})}),"\n",(0,s.jsx)(n.h4,{id:"name-required",children:"name (required)"}),"\n",(0,s.jsx)(n.p,{children:"A unique name for the parser. Used as the key for the parser's value in the\ncontext."}),"\n",(0,s.jsx)(n.h4,{id:"parser-required",children:"parser (required)"}),"\n",(0,s.jsx)(n.p,{children:"The parser object to be registered."}),"\n",(0,s.jsx)(n.h3,{id:"metrics",children:".metrics"}),"\n",(0,s.jsx)(n.p,{children:"Property that exposes a metric stream. This stream joins all internal metrics\nstreams into one stream resulting in all metrics from all sub modules being\nexposed here."}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"https://github.com/metrics-js/metric",title:"@metrics/metric",children:"@metrics/metric"})," for full documentation."]}),"\n",(0,s.jsx)(n.h2,{id:"podlet-resource",children:"Podlet Resource"}),"\n",(0,s.jsx)(n.p,{children:"A registered podlet is stored in a Podlet Resource object."}),"\n",(0,s.jsx)(n.p,{children:"The podlet Resource object contains methods for retrieving the content of a\npodlet. The URI of the content of a component is defined in the\ncomponent's manifest. This is the content root of the component."}),"\n",(0,s.jsx)(n.p,{children:"A podlet resource object has the following API:"}),"\n",(0,s.jsx)(n.h3,{id:"fetchhttpincoming-options",children:".fetch(HttpIncoming, options)"}),"\n",(0,s.jsxs)(n.p,{children:["Fetches the content of the podlet. Returns a ",(0,s.jsx)(n.code,{children:"Promise"})," which resolves with a\nPodlet Response object containing the keys ",(0,s.jsx)(n.code,{children:"content"}),", ",(0,s.jsx)(n.code,{children:"headers"}),", ",(0,s.jsx)(n.code,{children:"css"})," and ",(0,s.jsx)(n.code,{children:"js"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"httpincoming-required-2",children:"HttpIncoming (required)"}),"\n",(0,s.jsxs)(n.p,{children:["An ",(0,s.jsx)(n.a,{href:"/docs/api/incoming",children:(0,s.jsx)(n.code,{children:"HttpIncoming"})}),' object. This is normally provided by the\n"middleware" which runs on the incoming request to the layout prior to the\nprocess of fetching podlets.']}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"/docs/api/incoming",children:(0,s.jsx)(n.code,{children:"HttpIncoming"})})," object is normally found on a request bound\nproperty of the request or response object."]}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\napp.get(layout.pathname(), async (req, res, next) => {\n    const incoming = res.locals.podium;\n\n    const response = await podlet.fetch(incoming);\n    res.podiumSend(`\n        <section>${response.content}</section>\n    `);\n});\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\napp.route({\n    method: 'GET',\n    path: layout.pathname(),\n    handler: await (request, h) => {\n        const incoming = request.app.podium;\n\n        const response = await podlet.fetch(incoming);\n\n        h.podiumSend(`\n            <section>${response.content}</section>\n        `);\n    },\n});\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\napp.get(layout.pathname(), async (request, reply) => {\n    const incoming = reply.app.podium;\n\n    const response = await podlet.fetch(incoming);\n\n    reply.podiumSend(`\n        <section>${response.content}</section>\n    `);\n});\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    const response = await podlet.fetch(incoming);\n\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/html');\n    res.end(layout.render(incoming, `\n        <section>${response.content}</section>\n    `));\n});\n"})})})]}),"\n",(0,s.jsx)(n.h4,{id:"options-optional",children:"options (optional)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"option"}),(0,s.jsx)(n.th,{children:"type"}),(0,s.jsx)(n.th,{children:"default"}),(0,s.jsx)(n.th,{children:"required"}),(0,s.jsx)(n.th,{children:"details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"pathname"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"A path which will be appended to the content root of the podlet when requested"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"headers"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"An Object which will be appended as HTTP headers to the request to fetch the podlets's content"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"query"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"An Object which will be appended as query parameters to the request to fetch the podlets's content"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"return-value",children:"return value"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const result = await component.fetch();\nconsole.log(result.content);\nconsole.log(result.headers);\nconsole.log(result.js);\nconsole.log(result.css);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"streamhttpincoming-options",children:".stream(HttpIncoming, options)"}),"\n",(0,s.jsxs)(n.p,{children:["Streams the content of the component. Returns a ",(0,s.jsx)(n.code,{children:"ReadableStream"})," which streams\nthe content of the component. Before the stream starts flowing a ",(0,s.jsx)(n.code,{children:"beforeStream"}),"\nevent with a Podlet Response object, containing ",(0,s.jsx)(n.code,{children:"headers"}),", ",(0,s.jsx)(n.code,{children:"css"})," and ",(0,s.jsx)(n.code,{children:"js"}),"\nreferences is emitted."]}),"\n",(0,s.jsx)(n.h4,{id:"httpincoming-required-3",children:"HttpIncoming (required)"}),"\n",(0,s.jsxs)(n.p,{children:["An ",(0,s.jsx)(n.a,{href:"/docs/api/incoming",children:(0,s.jsx)(n.code,{children:"HttpIncoming"})})," object. This is normally provided by the\nmiddleware which runs on the incoming request to the layout prior to the\nprocess of fetching podlets."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"/docs/api/incoming",children:(0,s.jsx)(n.code,{children:"HttpIncoming"})})," object is normally found on a request\nbound property of the request or response object."]}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\napp.get(layout.pathname(), async (req, res, next) => {\n    const incoming = res.locals.podium;\n\n    const stream = podlet.stream(incoming);\n    stream.pipe(res);\n});\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\napp.route({\n    method: 'GET',\n    path: layout.pathname(),\n    handler: (request, h) => {\n        const incoming = request.app.podium;\n\n        const stream = podlet.stream(incoming);\n        return h.response(stream);\n    },\n});\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\napp.get(layout.pathname(), (request, reply) => {\n    const incoming = reply.app.podium;\n\n    const stream = podlet.stream(incoming);\n    stream.pipe(reply);\n});\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/html');\n\n    const stream = podlet.stream(incoming);\n    stream.pipe(res);\n});\n"})})})]}),"\n",(0,s.jsx)(n.h4,{id:"options-optional-1",children:"options (optional)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"option"}),(0,s.jsx)(n.th,{children:"type"}),(0,s.jsx)(n.th,{children:"default"}),(0,s.jsx)(n.th,{children:"required"}),(0,s.jsx)(n.th,{children:"details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"pathname"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"A path which will be appended to the content root of the podlet when requested"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"headers"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"An object which will be appended as HTTP headers to the request to fetch the podlets's content"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"query"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"An object which will be appended as query parameters to the request to fetch the podlets's content"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"event-beforestream",children:"Event: beforeStream"}),"\n",(0,s.jsxs)(n.p,{children:["A ",(0,s.jsx)(n.code,{children:"beforeStream"})," event is emitted before the stream starts flowing. A response\nobject with keys ",(0,s.jsx)(n.code,{children:"headers"}),", ",(0,s.jsx)(n.code,{children:"js"})," and ",(0,s.jsx)(n.code,{children:"css"})," is emitted with the event."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"headers"})," will always contain the response headers from the podlet. If the\nresource manifest defines JavaScript assets, ",(0,s.jsx)(n.code,{children:"js"})," will contain the value from\nthe manifest file otherwise ",(0,s.jsx)(n.code,{children:"js"})," will be an empty string. If the resource\nmanifest defines CSS assets, ",(0,s.jsx)(n.code,{children:"css"})," will contain the value from the manifest file\notherwise ",(0,s.jsx)(n.code,{children:"css"})," will be an empty string."]}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\napp.get(layout.pathname(), async (req, res, next) => {\n    const incoming = res.locals.podium;\n\n    const stream = podlet.stream(incoming);\n    stream.once('beforeStream', data => {\n        console.log(data.headers);\n        console.log(data.css);\n        console.log(data.js);\n    });\n\n    stream.pipe(res);\n});\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\napp.route({\n    method: 'GET',\n    path: layout.pathname(),\n    handler: (request, h) => {\n        const incoming = request.app.podium;\n\n        const stream = podlet.stream(incoming);\n        stream.once('beforeStream', data => {\n            console.log(data.headers);\n            console.log(data.css);\n            console.log(data.js);\n        });\n\n        return h.response(stream);\n    },\n});\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\napp.get(layout.pathname(), (request, reply) => {\n    const incoming = reply.app.podium;\n\n    const stream = podlet.stream(incoming);\n    stream.once('beforeStream', data => {\n        console.log(data.headers);\n        console.log(data.css);\n        console.log(data.js);\n    });\n\n    stream.pipe(reply);\n});\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\nconst server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    const stream = podlet.stream(incoming);\n    stream.once('beforeStream', data => {\n        console.log(data.headers);\n        console.log(data.css);\n        console.log(data.js);\n    });\n\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/html');\n\n    stream.pipe(res);\n});\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"refresh",children:".refresh()"}),"\n",(0,s.jsx)(n.p,{children:"This method will refresh a resource by reading its manifest and fallback\nif defined in the manifest. The method will not call the content URI\nof a component."}),"\n",(0,s.jsx)(n.p,{children:"If the internal cache in the client already has a manifest cached, this will\nbe thrown away and replaced when the new manifest is successfully fetched. If a\nnew manifest cannot be successfully fetched, the old manifest will be kept in\ncache."}),"\n",(0,s.jsxs)(n.p,{children:["If a manifest is successfully fetched, this method will resolve with a ",(0,s.jsx)(n.code,{children:"true"}),"\nvalue. If a manifest is not successfully fetched, it will resolve with ",(0,s.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const podlet = layout.client.register({\n  uri: 'http://foo.site.com/manifest.json',\n  name: 'foo',\n});\n\nconst status = await podlet.refresh();\n\nconsole.log(status); // true\n"})}),"\n",(0,s.jsx)(n.h3,{id:"name-1",children:".name"}),"\n",(0,s.jsxs)(n.p,{children:["A property returning the name of the Podium resource. This is the name provided\nduring the call to ",(0,s.jsx)(n.code,{children:"register"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"uri",children:".uri"}),"\n",(0,s.jsx)(n.p,{children:"A property returning the location of the Podium resource."}),"\n",(0,s.jsx)(n.h2,{id:"podlet-response",children:"Podlet Response"}),"\n",(0,s.jsxs)(n.p,{children:["When a podlet is requested by the ",(0,s.jsx)(n.a,{href:"#fetchhttpincoming-options",children:(0,s.jsx)(n.code,{children:".client.fetch()"})}),"\nmethod it will return a ",(0,s.jsx)(n.code,{children:"Promise"}),"  which will resolve with a podlet response\nobject. If a podlet is requested by the ",(0,s.jsx)(n.a,{href:"#streamhttpincoming-options",children:(0,s.jsx)(n.code,{children:".client.stream()"})}),"\nmethod a ",(0,s.jsx)(n.code,{children:"beforeStream"})," event will emit a podlet response object."]}),"\n",(0,s.jsx)(n.p,{children:"This object hold the response of the HTTP request to the content URL of the\npodlet which was requested."}),"\n",(0,s.jsx)(n.p,{children:"An podlet response instance has the following properties:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"property"}),(0,s.jsx)(n.th,{children:"type"}),(0,s.jsx)(n.th,{children:"getter"}),(0,s.jsx)(n.th,{children:"setter"}),(0,s.jsx)(n.th,{children:"default"}),(0,s.jsx)(n.th,{children:"details"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"content"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})}),(0,s.jsx)(n.td,{children:"\u2713"}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"The content of the podlet. Normally a string of HTML."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"headers"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"object"})}),(0,s.jsx)(n.td,{children:"\u2713"}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"{}"})}),(0,s.jsx)(n.td,{children:"The HTTP headers the content route of the podlet responded with."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"css"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"array"})}),(0,s.jsx)(n.td,{children:"\u2713"}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[]"})}),(0,s.jsxs)(n.td,{children:["An array of ",(0,s.jsx)(n.a,{href:"/docs/api/assets#assetcss",children:"AssetCSS"})," objects holding the CSS references registered by the podlet."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"js"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"array"})}),(0,s.jsx)(n.td,{children:"\u2713"}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[]"})}),(0,s.jsxs)(n.td,{children:["An array of ",(0,s.jsx)(n.a,{href:"/docs/api/assets#assetjs",children:"AssetJS"})," objects holding the JS references registered by the podlet."]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"respodiumsendfragment",children:"res.podiumSend(fragment)"}),"\n",(0,s.jsxs)(n.p,{children:["Method on the ",(0,s.jsx)(n.code,{children:"http.ServerResponse"})," object for sending HTML fragments. Calls\nthe send / write method on the ",(0,s.jsx)(n.code,{children:"http.ServerResponse"})," object."]}),"\n",(0,s.jsxs)(n.p,{children:["This method wraps the provided fragment in a default HTML document before\ndispatching. You can use the ",(0,s.jsx)(n.code,{children:".view()"})," method to disable using a template or to\nset a custom template."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Example of sending an HTML fragment:"})}),"\n",(0,s.jsxs)(a.Z,{groupId:"server-frameworks",children:[(0,s.jsx)(i.Z,{value:"express",label:"Express",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"app.get(layout.pathname(), (req, res) => {\n    res.podiumSend('<h1>Hello World</h1>');\n});\n"})})}),(0,s.jsx)(i.Z,{value:"hapi",label:"Hapi",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"app.route({\n    method: 'GET',\n    path: layout.pathname(),\n    handler: (request, h) => {\n        return h.podiumSend('<h2>Hello world</h2>');\n    },\n});\n"})})}),(0,s.jsx)(i.Z,{value:"fastify",label:"Fastify",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"app.get(layout.pathname(), async (request, reply) => {\n    reply.podiumSend('<h2>Hello world</h2>');\n});\n"})})}),(0,s.jsx)(i.Z,{value:"http",label:"HTTP",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const server = http.createServer(async (req, res) => {\n    let incoming = new HttpIncoming(req, res);\n    incoming = await layout.process(incoming);\n\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'text/html');\n    res.end(layout.render(incoming, '<h2>Hello world</h2>'));\n});\n"})})})]})]})}function u(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},5162:(e,n,t)=>{t.d(n,{Z:()=>i});t(7294);var s=t(6010);const r={tabItem:"tabItem_Ymn6"};var a=t(5893);function i(e){let{children:n,hidden:t,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,s.Z)(r.tabItem,i),hidden:t,children:n})}},4866:(e,n,t)=>{t.d(n,{Z:()=>w});var s=t(7294),r=t(6010),a=t(2466),i=t(6550),l=t(469),o=t(1980),c=t(7392),d=t(12);function h(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,s.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:t,attributes:s,default:r}}=e;return{value:n,label:t,attributes:s,default:r}}))}(t);return function(e){const n=(0,c.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function u(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function j(e){let{queryString:n=!1,groupId:t}=e;const r=(0,i.k6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,o._X)(a),(0,s.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(r.location.search);n.set(a,e),r.replace({...r.location,search:n.toString()})}),[a,r])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,a=p(e),[i,o]=(0,s.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!u({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const s=t.find((e=>e.default))??t[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:a}))),[c,h]=j({queryString:t,groupId:r}),[m,x]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[r,a]=(0,d.Nk)(t);return[r,(0,s.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:r}),y=(()=>{const e=c??m;return u({value:e,tabValues:a})?e:null})();(0,l.Z)((()=>{y&&o(y)}),[y]);return{selectedValue:i,selectValue:(0,s.useCallback)((e=>{if(!u({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);o(e),h(e),x(e)}),[h,x,a]),tabValues:a}}var x=t(2389);const y={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var g=t(5893);function f(e){let{className:n,block:t,selectedValue:s,selectValue:i,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.o5)(),d=e=>{const n=e.currentTarget,t=o.indexOf(n),r=l[t].value;r!==s&&(c(n),i(r))},h=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},n),children:l.map((e=>{let{value:n,label:t,attributes:a}=e;return(0,g.jsx)("li",{role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>o.push(e),onKeyDown:h,onClick:d,...a,className:(0,r.Z)("tabs__item",y.tabItem,a?.className,{"tabs__item--active":s===n}),children:t??n},n)}))})}function v(e){let{lazy:n,children:t,selectedValue:r}=e;const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=a.find((e=>e.props.value===r));return e?(0,s.cloneElement)(e,{className:"margin-top--md"}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function b(e){const n=m(e);return(0,g.jsxs)("div",{className:(0,r.Z)("tabs-container",y.tabList),children:[(0,g.jsx)(f,{...e,...n}),(0,g.jsx)(v,{...e,...n})]})}function w(e){const n=(0,x.Z)();return(0,g.jsx)(b,{...e,children:h(e.children)},String(n))}},1151:(e,n,t)=>{t.d(n,{Z:()=>l,a:()=>i});var s=t(7294);const r={},a=s.createContext(r);function i(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);