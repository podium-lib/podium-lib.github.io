"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4646],{8372:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var l=n(5893),a=n(1151);const o={id:"fallbacks",title:"Fallbacks"},s=void 0,i={id:"podlet/fallbacks",title:"Fallbacks",description:"What happens if a podlet server is down? Unresponsive? Responding too slowly? By default Podium will simply render an empty string in its place. You might, however, want to have some measure of control over what gets shown. Enter fallbacks.",source:"@site/docs/podlet/fallbacks.md",sourceDirName:"podlet",slug:"/podlet/fallbacks",permalink:"/docs/podlet/fallbacks",draft:!1,unlisted:!1,editUrl:"https://github.com/podium-lib/podium-lib.github.io/tree/main/website/docs/docs/podlet/fallbacks.md",tags:[],version:"current",frontMatter:{id:"fallbacks",title:"Fallbacks"},sidebar:"sidebar",previous:{title:"Getting Started",permalink:"/docs/podlet/getting_started"},next:{title:"Context",permalink:"/docs/podlet/context"}},r={},d=[{value:"How do fallbacks work?",id:"how-do-fallbacks-work",level:2},{value:"Defining a fallback route",id:"defining-a-fallback-route",level:2}];function c(e){const t={code:"code",h2:"h2",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.p,{children:"What happens if a podlet server is down? Unresponsive? Responding too slowly? By default Podium will simply render an empty string in its place. You might, however, want to have some measure of control over what gets shown. Enter fallbacks."}),"\n",(0,l.jsx)(t.h2,{id:"how-do-fallbacks-work",children:"How do fallbacks work?"}),"\n",(0,l.jsx)(t.p,{children:"On the first request to a podlet, Podium will request the podlet\u2019s manifest file inside of which it will discover the location of the podlets fallback route if one has been defined. It will then make a request to the fallback route and cache the response. Later, if the podlet server cannot be reached for any reason, or the request returns a non 200 response, Podium will simply display the podlet\u2019s cached fallback content instead."}),"\n",(0,l.jsx)(t.p,{children:"Note that the podlet\u2019s assets will still be served, so the fallback can depend on both JS and CSS being present once it\u2019s rendered."}),"\n",(0,l.jsx)(t.h2,{id:"defining-a-fallback-route",children:"Defining a fallback route"}),"\n",(0,l.jsxs)(t.p,{children:["With a podlet instance you call the ",(0,l.jsx)(t.code,{children:"fallback"})," function which will return the route from the manifest. By default this is at ",(0,l.jsx)(t.code,{children:"/fallback"}),". You then attach your handler which receives a simplified version of the context and returns the fallback you want."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-js",children:'const podlet = new Podlet(/*...*/);\n\nconst app = express();\n\napp.get(podlet.fallback(), (req, res) => {\n    res.status(200).podiumSend("<div>It didn\'t work :(</div>");\n});\n'})}),"\n",(0,l.jsx)(t.p,{children:"With a custom URL, which will be reflected in the manifest."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-js",children:"app.get(podlet.fallback('/my-custom-fallback-route'), (req, res) => {\n    res.status(200).podiumSend(\"<div>It didn't work :(</div>\");\n});\n"})}),"\n",(0,l.jsx)(t.p,{children:"You can also use some of the Podium context that's not request bound. This is useful if you need to serve a different fallback depending on where the podlet is mounted."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-js",children:"app.get(podlet.fallback(), (req, res) => {\n    const { publicPathname } = res.locals.podium.context;\n    res.status(200).podiumSend(\n        `<div data-public-path-name=${publicPathname}>It didn't work :(</div>`\n    );\n});\n"})}),"\n",(0,l.jsx)(t.p,{children:"The fallback can also point to an external service."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-js",children:"const podlet = new Podlet(/*...*/);\n\npodlet.fallback('https://www.example.com/my-fallback');\n"})})]})}function p(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,l.jsx)(t,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>i,a:()=>s});var l=n(7294);const a={},o=l.createContext(a);function s(e){const t=l.useContext(o);return l.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),l.createElement(o.Provider,{value:t},e.children)}}}]);