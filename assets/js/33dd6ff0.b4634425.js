"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8522],{2647:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>d,metadata:()=>s,toc:()=>l});var r=n(5893),i=n(1151);const d={id:"handling_redirects",title:"Handling redirects from podlets"},o=void 0,s={id:"layout/handling_redirects",title:"Handling redirects from podlets",description:"By default, the client registered in a layout will follow a redirect, and use the HTML response as if it came from the podlet directly.",source:"@site/docs/layout/handling_redirects.md",sourceDirName:"layout",slug:"/layout/handling_redirects",permalink:"/docs/layout/handling_redirects",draft:!1,unlisted:!1,editUrl:"https://github.com/podium-lib/podium-lib.github.io/tree/main/website/docs/docs/layout/handling_redirects.md",tags:[],version:"current",frontMatter:{id:"handling_redirects",title:"Handling redirects from podlets"},sidebar:"sidebar",previous:{title:"Local Development",permalink:"/docs/layout/local_development"},next:{title:"Getting Started",permalink:"/docs/api/getting_started"}},a={},l=[{value:"Define a podlet as redirectable",id:"define-a-podlet-as-redirectable",level:2},{value:"Trigger the redirect from a podlet",id:"trigger-the-redirect-from-a-podlet",level:2}];function c(e){const t={code:"code",em:"em",h2:"h2",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.p,{children:["By default, the client registered in a layout will ",(0,r.jsx)(t.em,{children:"follow"})," a redirect, and use the HTML response as if it came from the podlet directly."]}),"\n",(0,r.jsx)(t.h2,{id:"define-a-podlet-as-redirectable",children:"Define a podlet as redirectable"}),"\n",(0,r.jsxs)(t.p,{children:["If a podlet should trigger a redirect for the end user, or you want to handle redirects in a different way, you have to configure the client as ",(0,r.jsx)(t.code,{children:"redirectable"}),":"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"const gettingStarted = layout.client.register({\n  /* ... */\n  redirectable: true,\n});\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Then, in the request handler for the ",(0,r.jsx)(t.em,{children:"layout"}),":"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:'app.get("/", async (req, res) => {\n  const incoming = res.locals.podium;\n  const response = await gettingStarted.fetch(incoming);\n\n  if (response.redirect) {\n    return res\n      .status(response.redirect.statusCode)\n      .setHeader("Location", response.redirect.location)\n      .send();\n  }\n\n  incoming.view.title = "Hello, Layout!";\n  res.podiumSend(`<div>${response}</div>`);\n});\n'})}),"\n",(0,r.jsx)(t.h2,{id:"trigger-the-redirect-from-a-podlet",children:"Trigger the redirect from a podlet"}),"\n",(0,r.jsxs)(t.p,{children:["Once you have configured the layout to handle a redirectable podlet, the podlet can send a ",(0,r.jsx)(t.code,{children:"Location"})," header and the correct HTTP status code."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:'app.get(podlet.content(), (req, res) => {\n\n  const shouldRedirect = /* Determine whether a redirect should happen */;\n  if (shouldRedirect) {\n    return res\n      .status(302)\n      .setHeader("Location", "https://podium-lib.io")\n      .send();\n  }\n\n  res.status(200).podiumSend(`\n    <div id="app">Hello, Podlet!</div>\n  `);\n});\n'})})]})}function u(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>s,a:()=>o});var r=n(7294);const i={},d=r.createContext(i);function o(e){const t=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(d.Provider,{value:t},e.children)}}}]);