"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1985],{4410:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var s=n(5893),i=n(1151);const o={id:"getting_started",title:"Getting Started"},a=void 0,r={id:"layout/getting_started",title:"Getting Started",description:"This guide will walk you through how to get started building layouts for Podium in Node",source:"@site/docs/layout/getting_started.md",sourceDirName:"layout",slug:"/layout/getting_started",permalink:"/docs/layout/getting_started",draft:!1,unlisted:!1,editUrl:"https://github.com/podium-lib/podium-lib.github.io/tree/main/website/docs/docs/layout/getting_started.md",tags:[],version:"current",frontMatter:{id:"getting_started",title:"Getting Started"},sidebar:"sidebar",previous:{title:"Podlet To Podlet Communication In The Browser",permalink:"/docs/podlet/podlet_to_podlet_communication"},next:{title:"The Podium Context",permalink:"/docs/layout/context"}},d={},l=[{value:"Before you begin",id:"before-you-begin",level:2},{value:"Step 1: Project setup",id:"step-1-project-setup",level:2},{value:"Step 2: Install dependencies",id:"step-2-install-dependencies",level:2},{value:"Step 3: Import dependencies",id:"step-3-import-dependencies",level:2},{value:"Step 4: Instantiate instances",id:"step-4-instantiate-instances",level:2},{value:"Step 5: Register a basic podlet for use in the page",id:"step-5-register-a-basic-podlet-for-use-in-the-page",level:2},{value:"Step 6: Mount middleware",id:"step-6-mount-middleware",level:2},{value:"Step 7: Create a route to fetch and display a podlet&#39;s content",id:"step-7-create-a-route-to-fetch-and-display-a-podlets-content",level:2},{value:"Step 8: Start the server",id:"step-8-start-the-server",level:2},{value:"The complete code",id:"the-complete-code",level:2}];function c(e){const t={a:"a",code:"code",em:"em",h2:"h2",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"This guide will walk you through how to get started building layouts for Podium in Node\njs using the Express js HTTP framework. At the end you will have created a fairly bare bones page displaying content from a single podlet server."}),"\n",(0,s.jsx)(t.h2,{id:"before-you-begin",children:"Before you begin"}),"\n",(0,s.jsxs)(t.p,{children:["Ideally, you should have some familiarity with building apps with JavaScript and\nNode.js. You will also need to have Node.js installed at version 8 or higher.\nThe npm cli will be installed automatically when you install Node.js. Additionally, you should familiarize yourself with the Podium's ",(0,s.jsx)(t.a,{href:"/docs/podium/conceptual_overview",children:"high level concepts"})," and understand ",(0,s.jsx)(t.a,{href:"/docs/podlet/getting_started",children:"how to build a podlet"})," with Podium."]}),"\n",(0,s.jsx)(t.h2,{id:"step-1-project-setup",children:"Step 1: Project setup"}),"\n",(0,s.jsx)(t.p,{children:"First, we need to initialize a new node project in an empty directory."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"mkdir basic-layout\ncd basic-layout\nnpm init\n"})}),"\n",(0,s.jsx)(t.p,{children:"Follow the prompts (mostly accepting defaults) to complete project\ninitialization."}),"\n",(0,s.jsx)(t.h2,{id:"step-2-install-dependencies",children:"Step 2: Install dependencies"}),"\n",(0,s.jsxs)(t.p,{children:["Next, we need to install and import our dependencies, ",(0,s.jsx)(t.code,{children:"express"})," and\n",(0,s.jsx)(t.code,{children:"@podium/layout"}),". To do so, run:"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"npm install express @podium/layout\n"})}),"\n",(0,s.jsx)(t.h2,{id:"step-3-import-dependencies",children:"Step 3: Import dependencies"}),"\n",(0,s.jsxs)(t.p,{children:["Create a file ",(0,s.jsx)(t.code,{children:"index.js"}),", open it in your favorite text editor and import our 2 dependencies at the top of the file."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"const express = require('express');\nconst Layout = require('@podium/layout');\n"})}),"\n",(0,s.jsx)(t.h2,{id:"step-4-instantiate-instances",children:"Step 4: Instantiate instances"}),"\n",(0,s.jsxs)(t.p,{children:["Create an express app instance and instantiate the layout. ",(0,s.jsx)(t.code,{children:"name"})," and ",(0,s.jsx)(t.code,{children:"pathname"})," are required parameters. ",(0,s.jsx)(t.code,{children:"name"})," must be a unique identifier in camel casing. ",(0,s.jsx)(t.code,{children:"pathname"})," is a prefix path to where your layout will appear online. For our example here we can say that our page will be served at ",(0,s.jsx)(t.code,{children:"/demo"})," so ",(0,s.jsx)(t.code,{children:"pathname"})," should be set to ",(0,s.jsx)(t.code,{children:"/demo"}),". If our page were being served at the root of the server, ",(0,s.jsx)(t.code,{children:"pathname"})," would need to be ",(0,s.jsx)(t.code,{children:"/"}),"."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"const app = express();\n\nconst layout = new Layout({\n    name: 'myLayout', // required\n    pathname: '/demo', // required\n});\n"})}),"\n",(0,s.jsx)(t.h2,{id:"step-5-register-a-basic-podlet-for-use-in-the-page",children:"Step 5: Register a basic podlet for use in the page"}),"\n",(0,s.jsxs)(t.p,{children:["For this step, we can use the podlet we created in the ",(0,s.jsx)(t.a,{href:"/docs/podlet/getting_started",children:"podlets - getting started"})," guide. It's set up to run on port ",(0,s.jsx)(t.code,{children:"7100"})," so after we start it up, we can register our podlet's manifest file in our layout like so:"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"const podlet = layout.client.register({\n    name: 'myPodlet', // required\n    uri: 'http://localhost:7100/manifest.json', // required\n});\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"uri"})," here should point to the podlet's manifest file, not to its server root."]}),"\n",(0,s.jsx)(t.h2,{id:"step-6-mount-middleware",children:"Step 6: Mount middleware"}),"\n",(0,s.jsx)(t.p,{children:"Mount the layout instance's middleware into the express app. This important step adds layout specific middleware to the app to take care of such tasks as context parsing and proxying."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"app.use(layout.middleware());\n"})}),"\n",(0,s.jsx)(t.h2,{id:"step-7-create-a-route-to-fetch-and-display-a-podlets-content",children:"Step 7: Create a route to fetch and display a podlet's content"}),"\n",(0,s.jsxs)(t.p,{children:["This is the route that the layout server will use to return its html page. We create our route using the same ",(0,s.jsx)(t.code,{children:"pathname"})," value we gave the layout constructor."]}),"\n",(0,s.jsx)(t.p,{children:"In our route handler, we grab a request bound instance of HttpIncoming from the response object and hand it to the fetch method of our podlet client. This method returns a promise which resolves to be an object with the podlet's content and additional metadata which we can then insert into our page as shown below:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"app.get('/demo', async (req, res) => {\n    const incoming = res.locals.podium;\n    const response = await podlet.fetch(incoming);\n\n    incoming.view.title = 'My Super Page';\n\n    res.podiumSend(`<div>${response}</div>`);\n});\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Take note of the use of the ",(0,s.jsx)(t.code,{children:"incoming"})," object to set the page ",(0,s.jsx)(t.code,{children:"title"}),". You can read more about this in the ",(0,s.jsxs)(t.a,{href:"/docs/api/incoming",children:[(0,s.jsx)(t.code,{children:"HttpIncoming"})," docs"]})]}),"\n",(0,s.jsx)(t.p,{children:"In a more realistic example, you might fetch content from any number of podlets. Your page might be broken up into podlets representing the page header, footer, sidebar and so on. Since podlets are isolated and independent of each other, we can safely fetch content in parallel."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"app.get('/', (req, res) => {\n    const incoming = res.locals.podium;\n    const content = await Promise.all([\n        header.fetch(incoming),\n        sidebar.fetch(incoming),\n        podlet.fetch(incoming),\n        footer.fetch(incoming),\n    ]);\n    ...\n});\n"})}),"\n",(0,s.jsx)(t.h2,{id:"step-8-start-the-server",children:"Step 8: Start the server"}),"\n",(0,s.jsx)(t.p,{children:"Now, all thats left is to start the server and test it out"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"app.listen(7000);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["We call ",(0,s.jsx)(t.code,{children:".listen(port)"})," on the express app instance and pass it a port"]}),"\n",(0,s.jsx)(t.p,{children:"We can run the app with:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"node index.js\n"})}),"\n",(0,s.jsx)(t.p,{children:"And we can then visit our page in a browser at:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"http://localhost:7000/demo\n"})}),"\n",(0,s.jsx)(t.p,{children:'If you see the text "This is the podlets html content" then you\'ve successfully created your first layout.'}),"\n",(0,s.jsx)(t.h2,{id:"the-complete-code",children:"The complete code"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"Example"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"const express = require('express');\nconst Layout = require('@podium/layout');\n\nconst app = express();\n\nconst layout = new Layout({\n    name: 'myLayout',\n    pathname: '/demo',\n});\n\nconst podlet = layout.client.register({\n    name: 'myPodlet',\n    uri: 'http://localhost:7100/manifest.json',\n});\n\napp.use(layout.middleware());\n\napp.get('/demo', async (req, res) => {\n    const incoming = res.locals.podium;\n    const response = await podlet.fetch(incoming);\n\n    incoming.view.title = 'My Super Page';\n\n    res.podiumSend(`<div>${response}</div>`);\n});\n\napp.listen(7000);\n"})})]})}function p(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>r,a:()=>a});var s=n(7294);const i={},o=s.createContext(i);function a(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);